{% import "macros/solar.html" as solar -%}
{% import "macros/head.html" as head -%}
{% import "macros/footer.html" as footer -%}

<!DOCTYPE html>
<html lang="{{ config.default_language }}"> {# TODO update to lang #}
    <head>
      {% block general_meta -%}
        {{ head::general_meta() }}
      {% endblock general_meta -%}

      {# TODO block title outside or inside: conservative approach rn #}
      <title>{% block title %}{{ config.title }}{% endblock title %}</title>

      {% block css -%}
      <link rel="stylesheet" href="{{ get_url(path='style.css', trailing_slash=false) }}">

      {%- if config.extra.custom_css is defined -%}
      <link rel="stylesheet" href="{{ get_url(path='custom.css') }}">
      {% endif %}
      {% endblock css -%}

      {%- block rss -%}
      {{ head::rss() }}
      {%- endblock rss -%}

      {# TODO math block with katex support #}
    </head>

    {% block body_class %} {# TODO looks like a hacky move #}
    <body>
    {% endblock body_class %}

    {{ solar::charge_indicator() }}
    <main>
      <header class="top">
        <h1><a href="{{ config.base_url }}/">{{ config.title }}</a></h1>
        <div class="subtitle">
          <a href="{{ config.base_url }}/power.html">{{ config.description }} <svg class="icon" viewBox="0 0 500 500"><title>Solar</title><circle class="svg_fill" cx="248.48" cy="252.55" r="97.03"/><rect class="svg_fill" x="234.53" y="17.45" width="27.9" height="112.39"/><rect class="svg_fill" x="234.53" y="375.25" width="27.9" height="112.39"/><rect class="svg_fill" x="413.42" y="196.35" width="27.9" height="112.39" transform="translate(679.92 -174.83) rotate(90)"/><rect class="svg_fill" x="55.63" y="196.35" width="27.9" height="112.39" transform="translate(322.12 182.97) rotate(90)"/><rect class="svg_fill" x="361.03" y="69.85" width="27.9" height="112.39" transform="translate(198.96 -228.23) rotate(45)"/><rect class="svg_fill" x="108.03" y="322.85" width="27.9" height="112.39" transform="translate(303.75 24.77) rotate(45)"/><rect class="svg_fill" x="361.03" y="322.85" width="27.9" height="112.39" transform="translate(908.15 381.93) rotate(135)"/><rect class="svg_fill" x="108.03" y="69.85" width="27.9" height="112.39" transform="translate(297.35 128.93) rotate(135)"/></svg></a>
        </div>
        <nav id="menu">
          <div id="menu-s">
            menu
          </div>
          <!-- TODO from hardcoded URLS to config.toml -->
          <ul id="menu-list">
            <li><a href="{{ config.base_url }}/about.html">About</a></li>
            <li class="low"><a class="category" href="{{ config.base_url }}/low-tech-solutions.html">Low-tech Solutions</a></li>
            <li class="hig"><a class="category" href="{{ config.base_url }}/high-tech-problems.html">High-tech Problems</a></li>
            <li class="obs"><a class="category" href="{{ config.base_url }}/obsolete-technology.html">Obsolete Technology</a></li>
            <li><a href="{{ config.base_url }}/archives.html">Archive</a></li>
            <li><a href="{{ config.base_url }}/donate.html">Donate</a></li>
            <!-- TODO move to feed.html macro and support multiple feeds -->
            <li class="social"><a href="{{ config.base_url }}/{{ config.feed_filename }}" type="application/rss+xml" rel="alternate" target="_blank"><svg viewBox="0 0 80 80" class="icon"><title>rss</title><circle cx="19.91" cy="58.23" r="6.86"/><path d="M67.89,65.72H55.7A41.86,41.86,0,0,0,13.89,23.91V11.73A54.06,54.06,0,0,1,67.89,65.72Z"/><path d="M48.93,65.72H36.75A22.88,22.88,0,0,0,13.89,42.87V30.68A35.08,35.08,0,0,1,48.93,65.72Z"/></svg></a></li>
          </ul>
        </nav>
        <!-- /#menu -->
      </header>
      <!-- /#banner -->

      {% block content %}{% endblock %}

      <footer id="content-info" class="body">
        <h2>
          <a href="{{ config.base_url }}/">{{ config.title }}</a>
        </h2>
        <div class="dashboard">
          <ul class="cols">
            <li>
              {{ footer::server_stats() }}
            </li>
            <li>
              {{ footer::forecast() }}
            </li>
            <li>
              {{ footer::info() }}
            </li>
            <li>
              {{ footer::contact() }}
            </li>
          </ul>
        </div>
      </footer>
      <!-- /#content-info -->
    </main>
    {{ solar::script() }}
  </body>
</html>
